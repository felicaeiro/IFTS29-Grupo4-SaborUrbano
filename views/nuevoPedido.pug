doctype html
html
    head
        title Nuevo Pedido
        link(rel="stylesheet", href="/css/styles.css")
        
    body
        h1 Crear un nuevo pedido

        form.form-nuevoPedido(method="POST", action="/pedidos")
            div.div-top
                div.div-element
                    label(for="fecha") Fecha:
                    input.form-input(type="date" name="fecha" required)
                
                div.div-element
                    label(for="id_cliente") Cliente:
                    select.form-input(name="id_cliente" required)
                        option(value="") Seleccione un cliente
                        each c in clientes
                            option(value=c._id) #{c.nombre} #{c.apellido}

                div.div-element
                    label(for="tipo") Tipo:
                    select.form-input(name="tipo")
                        option(value="Presencial") Presencial
                        option(value="Online") Online

                div.div-element
                    label(for="total") Total:
                    input.form-input#total(type="number", step="0.01", name="total", readonly, value=0)

                br

            div.div-bottom
                each p in productos
                    div
                        input(type="checkbox", name="productos", value=p._id, data-precio=p.precio)
                        | #{p.nombre}

            div.form-div-btn
                button.btn(type="submit") Crear pedido
                
        a(href="/pedidos")
            button.btn.btn-last Volver a la lista de pedidos



        //- Actualizar el total en tiempo real
    script.
        const totalInput = document.getElementById('total');
        const checkboxes = document.querySelectorAll('input[name="productos"]');

        function actualizarTotal() {
            let total = 0;
            checkboxes.forEach(cb => {
                if (cb.checked) total += parseFloat(cb.dataset.precio);
            });
            totalInput.value = total.toFixed(2);
        }
        checkboxes.forEach(cb => cb.addEventListener('change', actualizarTotal));
